USE WAREHOUSE ETL_WH;
USE database RETAIL_DW;

DESCRIBE TABLE RETAIL_DW.SILVER.ORDERS;



INSERT INTO RETAIL_DW.GOLD.DIM_CUSTOMER
 (
select DISTINCT
    CUSTOMER_ID,
    CUSTOMER_NAME,
    STORE_LOCATION
from
RETAIL_DW.SILVER.ORDERS
);

INSERT INTO RETAIL_DW.GOLD.DIM_PRODUCT
(
select DISTINCT
    MD5(PRODUCT_NAME || PRODUCT_CATEGORY || PRICE),
    PRODUCT_NAME,
    PRODUCT_CATEGORY,
    PRICE
from
RETAIL_DW.SILVER.ORDERS   
);

INSERT INTO RETAIL_DW.GOLD.DIM_PAY
(
select DISTINCT
    MD5(PAYMENT_METHOD),
    PAYMENT_METHOD
from
RETAIL_DW.SILVER.ORDERS
);


INSERT INTO RETAIL_DW.GOLD.FACT_ORDERS
(
select 
    TRANSACTION_ID,
    ORDER_TIMESTAMP,
    CUSTOMER_ID,
    MD5(PRODUCT_NAME || PRODUCT_CATEGORY),
    QUANTITY,
    TOTAL_AMOUNT,
    MD5(PAYMENT_METHOD)
from
RETAIL_DW.SILVER.ORDERS
);







